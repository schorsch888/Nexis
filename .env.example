# Nexis Security Environment Template
#
# [Baseline] 单组织/中小规模默认配置
# [Enterprise] 多租户与合规强化配置
#
# 实施步骤：
# 1) 复制本文件到 .env（不要提交 .env）
# 2) 为所有 *_SECRET/*_KEY/*_TOKEN 填入真实值
# 3) 按部署层级启用 Baseline 或 Enterprise 开关
#
# 检查清单：
# [ ] 未使用默认值
# [ ] 所有密钥长度符合策略
# [ ] 生产环境关闭 debug 与弱 TLS

# --------------------------------------------------
# 通用（Baseline + Enterprise）
# --------------------------------------------------
NEXIS_ENV=development
NEXIS_PROFILE=baseline
NEXIS_LOG_LEVEL=info
NEXIS_BIND_ADDR=0.0.0.0:8080
NEXIS_TLS_ENABLED=true
NEXIS_TLS_MIN_VERSION=1.2
NEXIS_AUDIT_LOG_ENABLED=true

# 身份与认证
NEXIS_JWT_ISSUER=https://auth.example.internal
NEXIS_JWT_AUDIENCE=nexis
NEXIS_JWT_JWKS_URL=https://auth.example.internal/.well-known/jwks.json
NEXIS_JWT_CLOCK_SKEW_SECONDS=60

# 数据库与缓存
NEXIS_DATABASE_URL=postgres://nexis:CHANGE_ME@db.internal:5432/nexis
NEXIS_DATABASE_POOL_SIZE=20
NEXIS_REDIS_URL=redis://cache.internal:6379/0

# 密钥（示例占位）
NEXIS_API_HMAC_SECRET=CHANGE_ME_MIN_32_CHARS
NEXIS_ENCRYPTION_KEY=CHANGE_ME_AES256_KEY
NEXIS_WEBHOOK_SIGNING_KEY=CHANGE_ME

# 漏洞与审计输出
NEXIS_SECURITY_REPORT_DIR=./artifacts/security
NEXIS_AUDIT_LOG_PATH=./logs/audit.ndjson

# --------------------------------------------------
# [Baseline] 建议项
# --------------------------------------------------
NEXIS_RBAC_MODE=rbac
NEXIS_DEFAULT_DENY=true
NEXIS_SECRET_ROTATION_DAYS=90
NEXIS_CERT_ROTATION_DAYS=365
NEXIS_REQUIRE_MTLS_INTERNAL=false

# --------------------------------------------------
# [Enterprise] 增强项
# --------------------------------------------------
NEXIS_PROFILE_ENTERPRISE=false
NEXIS_MULTI_TENANT_ENABLED=false
NEXIS_TENANT_ENFORCEMENT_MODE=strict
NEXIS_REQUIRE_MFA=true
NEXIS_REQUIRE_APPROVAL_FOR_PRIVILEGED_ACTIONS=true
NEXIS_BREAK_GLASS_ENABLED=true
NEXIS_BREAK_GLASS_TTL_MINUTES=30
NEXIS_AUDIT_IMMUTABLE_STORAGE=true
NEXIS_AUDIT_RETENTION_DAYS=365
NEXIS_SIEM_EXPORT_ENABLED=true
NEXIS_SBOM_REQUIRED=true
NEXIS_IMAGE_SIGNATURE_REQUIRED=true

# 企业 IdP / KMS（占位）
NEXIS_SSO_PROVIDER=oidc
NEXIS_SSO_ISSUER=https://sso.enterprise.internal
NEXIS_SSO_CLIENT_ID=CHANGE_ME
NEXIS_SSO_CLIENT_SECRET=CHANGE_ME
NEXIS_KMS_ENDPOINT=https://kms.enterprise.internal
NEXIS_KMS_KEY_ID=CHANGE_ME
